<%
   changeset_data = {:id => changeset.id}

   if changeset.has_valid_bbox?
     bbox = changeset.bbox.to_unscaled
     changeset_data[:bbox] = {
       :minlon => bbox.min_lon,
       :minlat => bbox.min_lat,
       :maxlon => bbox.max_lon,
       :maxlat => bbox.max_lat
     }
   end
%>

<%= content_tag "li", :id => "changeset_#{changeset.id}", :data => {:changeset => changeset_data} do %>
  <p class="comment">
      <a class="changeset_id" href="<%= changeset_path(changeset.id) %>">
        <% if changeset.tags['comment'].to_s != '' %>
          <%= linkify(h(changeset.tags['comment'])) %>
        <% else %>
          <%= t 'changeset.changeset.no_comment' %>
        <% end %>
      </a>
  </p>

  <span class='date'>
    <% if changeset.closed_at > DateTime.now %>
      <%= t 'changeset.changeset.still_editing' %>
    <% else %>
      <% closed_at = l changeset.closed_at, :format => :long %>
      <abbr title='<%= closed_at %>'><%= distance_of_time_in_words_to_now(closed_at) %></abbr>
    <% end %>
  </span>

  <% unless params.key?(:display_name) %>
    <span class="user"> by 
      <% if changeset.user.data_public? %>
        <%= link_to changeset.user.display_name, user_path(changeset.user.display_name) %>
      <% else %>
        <i><%= t 'changeset.changeset.anonymous' %></i>
      <% end %>
    </span>
  <% end %>
<% end %>
