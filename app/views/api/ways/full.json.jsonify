json.ingest! render(:partial => "api/map/root_attributes")

all = @nodes + @ways

# FIXME this is really ugly!

json.elements(all) do |obj|
  if obj.is_a? Node
     node = obj
     json.ingest!  render(:partial => "api/map/node", :object => node)
  end

  if obj.is_a? Way
     way = obj
     json.ingest! render(:partial => "api/map/way", :object => way)
  end
end
