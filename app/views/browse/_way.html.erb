<% if way.redacted? && !params[:show_redactions] %>
  <div class="browse-section browse-redacted">
    <%= t "browse.redacted.message_html",
          :type => t("browse.redacted.type.way"),
          :version => way.version,
          :redaction_link => link_to(t("browse.redacted.redaction",
                                       :id => way.redaction.id), way.redaction) %>
  </div>
<% else %>
  <%= tag.div :class => ["browse-section", "browse-way", { "text-body-secondary" => way.redacted? }] do %>
    <%= render :partial => "browse/common_details", :object => way %>

    <% unless way.containing_relation_members.empty? %>
      <h4><%= t "browse.part_of" %></h4>
      <details <%= "open" if way.containing_relation_members.count < 10 %>>
        <summary><%= t "browse.part_of_relations", :count => way.containing_relation_members.uniq.count %></summary>
        <ul class="list-unstyled browse-element-list">
          <%= render :partial => "browse/containing_relation", :collection => way.containing_relation_members.uniq %>
        </ul>
      </details>
    <% end %>

    <% unless way.way_nodes.empty? %>
      <h4><%= t ".nodes" %></h4>
      <details <%= "open" if way.way_nodes.count < 10 %>>
        <summary><%= t ".nodes_count", :count => way.way_nodes.count %></summary>
        <ul class="list-unstyled browse-element-list">
          <% group_way_nodes(way).each do |node_group| %>
            <%= element_list_item "node", node_group[:nodes].first do %>
              <div>
                <% node_group[:nodes].each_with_index do |node, i| %>
                  <%= " Â· " if i.positive? %>
                  <%= element_single_current_link "node", node %>
                <% end %>
              </div>
              <% if node_group[:related_ways].size.positive? %>
                <%= tag.details :open => node_group[:open] do %>
                  <summary><%= t ".also_part_of_ways", :count => node_group[:related_ways].size %></summary>
                  <ul class="list-unstyled browse-element-list">
                    <% node_group[:related_ways].each do |related_way| %>
                      <%= element_list_item "way", related_way do %>
                        <%= element_single_current_link "way", related_way %>
                      <% end %>
                    <% end %>
                  </ul>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        </ul>
      </details>
    <% end %>
  <% end %>
<% end %>
